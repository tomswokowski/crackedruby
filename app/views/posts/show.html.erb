<section class="max-w-7xl mx-auto px-6 pt-4 md:pt-6 pb-10 md:pb-14">
  <%# ───────────────── Back link ───────────────── %>
  <% if @back_link_path.present? %>
    <div class="mb-3">
      <%= link_to @back_link_path,
        class: "inline-flex items-center gap-2 text-gray hover:text-black transition-colors text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ruby/30 rounded px-1" do %>
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
        </svg>
        <span><%= @back_link_text %></span>
      <% end %>
    </div>
  <% end %>

  <%# ───────────────── Header ───────────────── %>
  <div class="mb-8 pb-6 border-b border-gray-light max-w-3xl xl:max-w-4xl">
    <h1 class="relative text-3xl sm:text-4xl md:text-4xl font-black leading-tight tracking-tight text-black">
      <%= @post.title %>
      <span class="absolute left-0 -bottom-3 h-1.5 w-12 bg-ruby rounded-full"></span>
    </h1>

    <% if @post.description.present? %>
      <p class="mt-3 text-lg md:text-xl text-black/70 max-w-3xl">
        <%= @post.description %>
      </p>
    <% end %>

    <% is_blog = (@post.post_type == "blog") %>

    <div class="mt-4 flex flex-wrap items-center justify-between gap-3 text-sm">
      <% if is_blog %>
        <div class="flex flex-wrap items-center gap-x-4 gap-y-2 text-gray">
          <time datetime="<%= @post.created_at.iso8601 %>">
            <%= @post.created_at.strftime("%b %-d, %Y") %>
          </time>
          <span aria-hidden="true" class="text-gray/60">•</span>
          <span class="inline-flex items-center gap-1">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            <%= pluralize((@post.body.to_s.split.length / 200.0).ceil, "min") %> read
          </span>
        </div>
      <% else %>
        <div class="text-gray">
          <% if @post.category.present? %>
            <span><%= @post.category %></span>
            <% if @post.subcategory.present? %>
              <span class="mx-2 text-gray/60">›</span>
              <span><%= @post.subcategory %></span>
            <% end %>
          <% end %>
        </div>

        <% if @post.section_number.present? %>
          <span
            class="inline-flex items-center rounded-md bg-gray-light/60 text-black/80
                  px-2.5 py-1 font-semibold tracking-tight tabular-nums">
            <%= @post.section_number %>
          </span>
        <% end %>
      <% end %>
    </div>
  </div>

  <%# ───────────────── Content ───────────────── %>
  <div class="markdown-content max-w-3xl xl:max-w-4xl">
    <%== marksmithed @post.body %>
  </div>

  <%# ───────────────── Footer ───────────────── %>
  <div class="max-w-3xl xl:max-w-4xl mt-12 pt-8 border-t border-gray-light">
    <div class="flex items-center justify-between gap-4">
      <%= link_to @back_link_path,
        class: "inline-flex items-center gap-2 text-gray hover:text-black transition-colors text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ruby/30 rounded px-1" do %>
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
        </svg>
        <span><%= @back_link_text %></span>
      <% end %>

      <% if @post.post_type == "blog" %>
        <div class="text-sm text-gray">
          Last updated <%= @post.updated_at.strftime("%b %-d, %Y") %>
        </div>
      <% end %>
    </div>
  </div>
</section>
